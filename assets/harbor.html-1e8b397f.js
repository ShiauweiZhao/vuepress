import{_ as n,r as i,o,c as d,b as a,d as e,e as s,a as r}from"./app-632f27f1.js";const h={},c=r('<h1 id="harbor是什么" tabindex="-1"><a class="header-anchor" href="#harbor是什么" aria-hidden="true">#</a> harbor是什么？</h1><p>Harbor 是一个开源注册表，它使用策略和基于角色的访问控制来保护工件，确保图像被扫描并且没有漏洞，并将图像标记为可信。Harbor 是一个 CNCF 毕业项目，它提供合规性、性能和互操作性，以帮助您跨云原生计算平台（如 Kubernetes 和 Docker）一致且安全地管理工件。</p><h1 id="服务器安装harbor" tabindex="-1"><a class="header-anchor" href="#服务器安装harbor" aria-hidden="true">#</a> 服务器安装harbor</h1><h2 id="软件要求" tabindex="-1"><a class="header-anchor" href="#软件要求" aria-hidden="true">#</a> 软件要求</h2><ul><li>docker engine (&gt;=17.06)</li><li>docker compose (&gt;=1.18)</li></ul><h2 id="硬件要求" tabindex="-1"><a class="header-anchor" href="#硬件要求" aria-hidden="true">#</a> 硬件要求</h2><table><thead><tr><th style="text-align:center;">CPU</th><th style="text-align:center;">内存</th><th style="text-align:center;">硬盘</th></tr></thead><tbody><tr><td style="text-align:center;">4CPU</td><td style="text-align:center;">8G</td><td style="text-align:center;">160G</td></tr></tbody></table><h2 id="安装harbor" tabindex="-1"><a class="header-anchor" href="#安装harbor" aria-hidden="true">#</a> 安装harbor</h2><h3 id="下载harbor" tabindex="-1"><a class="header-anchor" href="#下载harbor" aria-hidden="true">#</a> 下载harbor</h3>',9),l={href:"https://github.com/goharbor/harbor/releases",target:"_blank",rel:"noopener noreferrer"},u=r(`<div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>➜  harbor tree
|-- LICENSE
|-- common.sh
|-- harbor.yml.tmpl
|-- install.sh
\`-- prepare

0 directories, 5 files

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ca证书" tabindex="-1"><a class="header-anchor" href="#ca证书" aria-hidden="true">#</a> CA证书</h3><p>由于我要将服务器映射到公网IP上，公网访问域名必须使用Https方式，所以我直接使用了阿里云的免费证书， 生成CA证书，我的域名注册在阿里云上，所以我使用了阿里云的免费证书，证书申请完成后，要将解析加入到域名的解析设置中，记录类型为TXT。然后下载 证书，到服务器上，放到/data/certs目录下,下载的证书是key和pem格式，针对pem格式证书，使用<code>cat server.pem &gt; server.crt</code>。</p><h3 id="配置harbor-yaml" tabindex="-1"><a class="header-anchor" href="#配置harbor-yaml" aria-hidden="true">#</a> 配置harbor.yaml</h3><div class="language-cp line-numbers-mode" data-ext="cp"><pre class="language-cp"><code></code></pre><div class="line-numbers" aria-hidden="true"></div></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="configuration-file-of-harbor" tabindex="-1"><a class="header-anchor" href="#configuration-file-of-harbor" aria-hidden="true">#</a> Configuration file of Harbor</h1><h1 id="the-ip-address-or-hostname-to-access-admin-ui-and-registry-service" tabindex="-1"><a class="header-anchor" href="#the-ip-address-or-hostname-to-access-admin-ui-and-registry-service" aria-hidden="true">#</a> The IP address or hostname to access admin UI and registry service.</h1><h1 id="do-not-use-localhost-or-127-0-0-1-because-harbor-needs-to-be-accessed-by-external-clients" tabindex="-1"><a class="header-anchor" href="#do-not-use-localhost-or-127-0-0-1-because-harbor-needs-to-be-accessed-by-external-clients" aria-hidden="true">#</a> DO NOT use localhost or 127.0.0.1, because Harbor needs to be accessed by external clients.</h1><p>hostname: docker.xxxx.xyz</p><h1 id="http-related-config" tabindex="-1"><a class="header-anchor" href="#http-related-config" aria-hidden="true">#</a> http related config</h1><p>http:</p><h1 id="port-for-http-default-is-80-if-https-enabled-this-port-will-redirect-to-https-port" tabindex="-1"><a class="header-anchor" href="#port-for-http-default-is-80-if-https-enabled-this-port-will-redirect-to-https-port" aria-hidden="true">#</a> port for http, default is 80. If https enabled, this port will redirect to https port</h1><p>port: 8080</p><h1 id="https-related-config" tabindex="-1"><a class="header-anchor" href="#https-related-config" aria-hidden="true">#</a> https related config</h1><p>https:</p><h1 id="https-port-for-harbor-default-is-443" tabindex="-1"><a class="header-anchor" href="#https-port-for-harbor-default-is-443" aria-hidden="true">#</a> https port for harbor, default is 443</h1><p>port: 8443</p><h1 id="the-path-of-cert-and-key-files-for-nginx" tabindex="-1"><a class="header-anchor" href="#the-path-of-cert-and-key-files-for-nginx" aria-hidden="true">#</a> The path of cert and key files for nginx</h1><p>certificate: /data/cert/server.crt private_key: /data/cert/server.key</p><h1 id="uncomment-following-will-enable-tls-communication-between-all-harbor-components" tabindex="-1"><a class="header-anchor" href="#uncomment-following-will-enable-tls-communication-between-all-harbor-components" aria-hidden="true">#</a> # Uncomment following will enable tls communication between all harbor components</h1><h1 id="internal-tls" tabindex="-1"><a class="header-anchor" href="#internal-tls" aria-hidden="true">#</a> internal_tls:</h1><h1 id="set-enabled-to-true-means-internal-tls-is-enabled" tabindex="-1"><a class="header-anchor" href="#set-enabled-to-true-means-internal-tls-is-enabled" aria-hidden="true">#</a> # set enabled to true means internal tls is enabled</h1><h1 id="enabled-true" tabindex="-1"><a class="header-anchor" href="#enabled-true" aria-hidden="true">#</a> enabled: true</h1><h1 id="put-your-cert-and-key-files-on-dir" tabindex="-1"><a class="header-anchor" href="#put-your-cert-and-key-files-on-dir" aria-hidden="true">#</a> # put your cert and key files on dir</h1><h1 id="dir-etc-harbor-tls-internal" tabindex="-1"><a class="header-anchor" href="#dir-etc-harbor-tls-internal" aria-hidden="true">#</a> dir: /etc/harbor/tls/internal</h1><h1 id="uncomment-external-url-if-you-want-to-enable-external-proxy" tabindex="-1"><a class="header-anchor" href="#uncomment-external-url-if-you-want-to-enable-external-proxy" aria-hidden="true">#</a> Uncomment external_url if you want to enable external proxy</h1><h1 id="and-when-it-enabled-the-hostname-will-no-longer-used" tabindex="-1"><a class="header-anchor" href="#and-when-it-enabled-the-hostname-will-no-longer-used" aria-hidden="true">#</a> And when it enabled the hostname will no longer used</h1><h1 id="external-url-https-reg-mydomain-com-8433" tabindex="-1"><a class="header-anchor" href="#external-url-https-reg-mydomain-com-8433" aria-hidden="true">#</a> external_url: https://reg.mydomain.com:8433</h1><h1 id="the-initial-password-of-harbor-admin" tabindex="-1"><a class="header-anchor" href="#the-initial-password-of-harbor-admin" aria-hidden="true">#</a> The initial password of Harbor admin</h1><h1 id="it-only-works-in-first-time-to-install-harbor" tabindex="-1"><a class="header-anchor" href="#it-only-works-in-first-time-to-install-harbor" aria-hidden="true">#</a> It only works in first time to install harbor</h1><h1 id="remember-change-the-admin-password-from-ui-after-launching-harbor" tabindex="-1"><a class="header-anchor" href="#remember-change-the-admin-password-from-ui-after-launching-harbor" aria-hidden="true">#</a> Remember Change the admin password from UI after launching Harbor.</h1><p>harbor_admin_password: Harbor12345</p><h1 id="harbor-db-configuration" tabindex="-1"><a class="header-anchor" href="#harbor-db-configuration" aria-hidden="true">#</a> Harbor DB configuration</h1><p>database:</p><h1 id="the-password-for-the-root-user-of-harbor-db-change-this-before-any-production-use" tabindex="-1"><a class="header-anchor" href="#the-password-for-the-root-user-of-harbor-db-change-this-before-any-production-use" aria-hidden="true">#</a> The password for the root user of Harbor DB. Change this before any production use.</h1><p>password: root123</p><h1 id="the-maximum-number-of-connections-in-the-idle-connection-pool-if-it-0-no-idle-connections-are-retained" tabindex="-1"><a class="header-anchor" href="#the-maximum-number-of-connections-in-the-idle-connection-pool-if-it-0-no-idle-connections-are-retained" aria-hidden="true">#</a> The maximum number of connections in the idle connection pool. If it &lt;=0, no idle connections are retained.</h1><p>max_idle_conns: 100</p><h1 id="the-maximum-number-of-open-connections-to-the-database-if-it-0-then-there-is-no-limit-on-the-number-of-open-connections" tabindex="-1"><a class="header-anchor" href="#the-maximum-number-of-open-connections-to-the-database-if-it-0-then-there-is-no-limit-on-the-number-of-open-connections" aria-hidden="true">#</a> The maximum number of open connections to the database. If it &lt;= 0, then there is no limit on the number of open connections.</h1><h1 id="note-the-default-number-of-connections-is-1024-for-postgres-of-harbor" tabindex="-1"><a class="header-anchor" href="#note-the-default-number-of-connections-is-1024-for-postgres-of-harbor" aria-hidden="true">#</a> Note: the default number of connections is 1024 for postgres of harbor.</h1><p>max_open_conns: 900</p><h1 id="the-default-data-volume" tabindex="-1"><a class="header-anchor" href="#the-default-data-volume" aria-hidden="true">#</a> The default data volume</h1><p>data_volume: /data</p><h1 id="harbor-storage-settings-by-default-is-using-data-dir-on-local-filesystem" tabindex="-1"><a class="header-anchor" href="#harbor-storage-settings-by-default-is-using-data-dir-on-local-filesystem" aria-hidden="true">#</a> Harbor Storage settings by default is using /data dir on local filesystem</h1><h1 id="uncomment-storage-service-setting-if-you-want-to-using-external-storage" tabindex="-1"><a class="header-anchor" href="#uncomment-storage-service-setting-if-you-want-to-using-external-storage" aria-hidden="true">#</a> Uncomment storage_service setting If you want to using external storage</h1><h1 id="storage-service" tabindex="-1"><a class="header-anchor" href="#storage-service" aria-hidden="true">#</a> storage_service:</h1><h1 id="ca-bundle-is-the-path-to-the-custom-root-ca-certificate-which-will-be-injected-into-the-truststore" tabindex="-1"><a class="header-anchor" href="#ca-bundle-is-the-path-to-the-custom-root-ca-certificate-which-will-be-injected-into-the-truststore" aria-hidden="true">#</a> # ca_bundle is the path to the custom root ca certificate, which will be injected into the truststore</h1><h1 id="of-registry-s-and-chart-repository-s-containers-this-is-usually-needed-when-the-user-hosts-a-internal-storage-with-self-signed-certificate" tabindex="-1"><a class="header-anchor" href="#of-registry-s-and-chart-repository-s-containers-this-is-usually-needed-when-the-user-hosts-a-internal-storage-with-self-signed-certificate" aria-hidden="true">#</a> # of registry&#39;s and chart repository&#39;s containers. This is usually needed when the user hosts a internal storage with self signed certificate.</h1><h1 id="ca-bundle" tabindex="-1"><a class="header-anchor" href="#ca-bundle" aria-hidden="true">#</a> ca_bundle:</h1><h1 id="storage-backend-default-is-filesystem-options-include-filesystem-azure-gcs-s3-swift-and-oss" tabindex="-1"><a class="header-anchor" href="#storage-backend-default-is-filesystem-options-include-filesystem-azure-gcs-s3-swift-and-oss" aria-hidden="true">#</a> # storage backend, default is filesystem, options include filesystem, azure, gcs, s3, swift and oss</h1><h1 id="for-more-info-about-this-configuration-please-refer-https-docs-docker-com-registry-configuration" tabindex="-1"><a class="header-anchor" href="#for-more-info-about-this-configuration-please-refer-https-docs-docker-com-registry-configuration" aria-hidden="true">#</a> # for more info about this configuration please refer https://docs.docker.com/registry/configuration/</h1><h1 id="filesystem" tabindex="-1"><a class="header-anchor" href="#filesystem" aria-hidden="true">#</a> filesystem:</h1><h1 id="maxthreads-100" tabindex="-1"><a class="header-anchor" href="#maxthreads-100" aria-hidden="true">#</a> maxthreads: 100</h1><h1 id="set-disable-to-true-when-you-want-to-disable-registry-redirect" tabindex="-1"><a class="header-anchor" href="#set-disable-to-true-when-you-want-to-disable-registry-redirect" aria-hidden="true">#</a> # set disable to true when you want to disable registry redirect</h1><h1 id="redirect" tabindex="-1"><a class="header-anchor" href="#redirect" aria-hidden="true">#</a> redirect:</h1><h1 id="disabled-false" tabindex="-1"><a class="header-anchor" href="#disabled-false" aria-hidden="true">#</a> disabled: false</h1><h1 id="trivy-configuration" tabindex="-1"><a class="header-anchor" href="#trivy-configuration" aria-hidden="true">#</a> Trivy configuration</h1><h1 id="" tabindex="-1"><a class="header-anchor" href="#" aria-hidden="true">#</a></h1><h1 id="trivy-db-contains-vulnerability-information-from-nvd-red-hat-and-many-other-upstream-vulnerability-databases" tabindex="-1"><a class="header-anchor" href="#trivy-db-contains-vulnerability-information-from-nvd-red-hat-and-many-other-upstream-vulnerability-databases" aria-hidden="true">#</a> Trivy DB contains vulnerability information from NVD, Red Hat, and many other upstream vulnerability databases.</h1><h1 id="it-is-downloaded-by-trivy-from-the-github-release-page-https-github-com-aquasecurity-trivy-db-releases-and-cached" tabindex="-1"><a class="header-anchor" href="#it-is-downloaded-by-trivy-from-the-github-release-page-https-github-com-aquasecurity-trivy-db-releases-and-cached" aria-hidden="true">#</a> It is downloaded by Trivy from the GitHub release page https://github.com/aquasecurity/trivy-db/releases and cached</h1><h1 id="in-the-local-file-system-in-addition-the-database-contains-the-update-timestamp-so-trivy-can-detect-whether-it" tabindex="-1"><a class="header-anchor" href="#in-the-local-file-system-in-addition-the-database-contains-the-update-timestamp-so-trivy-can-detect-whether-it" aria-hidden="true">#</a> in the local file system. In addition, the database contains the update timestamp so Trivy can detect whether it</h1><h1 id="should-download-a-newer-version-from-the-internet-or-use-the-cached-one-currently-the-database-is-updated-every" tabindex="-1"><a class="header-anchor" href="#should-download-a-newer-version-from-the-internet-or-use-the-cached-one-currently-the-database-is-updated-every" aria-hidden="true">#</a> should download a newer version from the Internet or use the cached one. Currently, the database is updated every</h1><h1 id="_12-hours-and-published-as-a-new-release-to-github" tabindex="-1"><a class="header-anchor" href="#_12-hours-and-published-as-a-new-release-to-github" aria-hidden="true">#</a> 12 hours and published as a new release to GitHub.</h1><p>trivy:</p><h1 id="ignoreunfixed-the-flag-to-display-only-fixed-vulnerabilities" tabindex="-1"><a class="header-anchor" href="#ignoreunfixed-the-flag-to-display-only-fixed-vulnerabilities" aria-hidden="true">#</a> ignoreUnfixed The flag to display only fixed vulnerabilities</h1><p>ignore_unfixed: false</p><h1 id="skipupdate-the-flag-to-enable-or-disable-trivy-db-downloads-from-github" tabindex="-1"><a class="header-anchor" href="#skipupdate-the-flag-to-enable-or-disable-trivy-db-downloads-from-github" aria-hidden="true">#</a> skipUpdate The flag to enable or disable Trivy DB downloads from GitHub</h1><h1 id="-1" tabindex="-1"><a class="header-anchor" href="#-1" aria-hidden="true">#</a></h1><h1 id="you-might-want-to-enable-this-flag-in-test-or-ci-cd-environments-to-avoid-github-rate-limiting-issues" tabindex="-1"><a class="header-anchor" href="#you-might-want-to-enable-this-flag-in-test-or-ci-cd-environments-to-avoid-github-rate-limiting-issues" aria-hidden="true">#</a> You might want to enable this flag in test or CI/CD environments to avoid GitHub rate limiting issues.</h1><h1 id="if-the-flag-is-enabled-you-have-to-download-the-trivy-offline-tar-gz-archive-manually-extract-trivy-db-and" tabindex="-1"><a class="header-anchor" href="#if-the-flag-is-enabled-you-have-to-download-the-trivy-offline-tar-gz-archive-manually-extract-trivy-db-and" aria-hidden="true">#</a> If the flag is enabled you have to download the <code>trivy-offline.tar.gz</code> archive manually, extract <code>trivy.db</code> and</h1><h1 id="metadata-json-files-and-mount-them-in-the-home-scanner-cache-trivy-db-path" tabindex="-1"><a class="header-anchor" href="#metadata-json-files-and-mount-them-in-the-home-scanner-cache-trivy-db-path" aria-hidden="true">#</a> <code>metadata.json</code> files and mount them in the <code>/home/scanner/.cache/trivy/db</code> path.</h1><p>skip_update: false</p><h1 id="-2" tabindex="-1"><a class="header-anchor" href="#-2" aria-hidden="true">#</a></h1><h1 id="the-offline-scan-option-prevents-trivy-from-sending-api-requests-to-identify-dependencies" tabindex="-1"><a class="header-anchor" href="#the-offline-scan-option-prevents-trivy-from-sending-api-requests-to-identify-dependencies" aria-hidden="true">#</a> The offline_scan option prevents Trivy from sending API requests to identify dependencies.</h1><h1 id="scanning-jar-files-and-pom-xml-may-require-internet-access-for-better-detection-but-this-option-tries-to-avoid-it" tabindex="-1"><a class="header-anchor" href="#scanning-jar-files-and-pom-xml-may-require-internet-access-for-better-detection-but-this-option-tries-to-avoid-it" aria-hidden="true">#</a> Scanning JAR files and pom.xml may require Internet access for better detection, but this option tries to avoid it.</h1><h1 id="for-example-the-offline-mode-will-not-try-to-resolve-transitive-dependencies-in-pom-xml-when-the-dependency-doesn-t" tabindex="-1"><a class="header-anchor" href="#for-example-the-offline-mode-will-not-try-to-resolve-transitive-dependencies-in-pom-xml-when-the-dependency-doesn-t" aria-hidden="true">#</a> For example, the offline mode will not try to resolve transitive dependencies in pom.xml when the dependency doesn&#39;t</h1><h1 id="exist-in-the-local-repositories-it-means-a-number-of-detected-vulnerabilities-might-be-fewer-in-offline-mode" tabindex="-1"><a class="header-anchor" href="#exist-in-the-local-repositories-it-means-a-number-of-detected-vulnerabilities-might-be-fewer-in-offline-mode" aria-hidden="true">#</a> exist in the local repositories. It means a number of detected vulnerabilities might be fewer in offline mode.</h1><h1 id="it-would-work-if-all-the-dependencies-are-in-local" tabindex="-1"><a class="header-anchor" href="#it-would-work-if-all-the-dependencies-are-in-local" aria-hidden="true">#</a> It would work if all the dependencies are in local.</h1><h1 id="this-option-doesn-t-affect-db-download-you-need-to-specify-skip-update-as-well-as-offline-scan-in-an-air-gapped-environment" tabindex="-1"><a class="header-anchor" href="#this-option-doesn-t-affect-db-download-you-need-to-specify-skip-update-as-well-as-offline-scan-in-an-air-gapped-environment" aria-hidden="true">#</a> This option doesn’t affect DB download. You need to specify &quot;skip-update&quot; as well as &quot;offline-scan&quot; in an air-gapped environment.</h1><p>offline_scan: false</p><h1 id="-3" tabindex="-1"><a class="header-anchor" href="#-3" aria-hidden="true">#</a></h1><h1 id="insecure-the-flag-to-skip-verifying-registry-certificate" tabindex="-1"><a class="header-anchor" href="#insecure-the-flag-to-skip-verifying-registry-certificate" aria-hidden="true">#</a> insecure The flag to skip verifying registry certificate</h1><p>insecure: false</p><h1 id="github-token-the-github-access-token-to-download-trivy-db" tabindex="-1"><a class="header-anchor" href="#github-token-the-github-access-token-to-download-trivy-db" aria-hidden="true">#</a> github_token The GitHub access token to download Trivy DB</h1><h1 id="-4" tabindex="-1"><a class="header-anchor" href="#-4" aria-hidden="true">#</a></h1><h1 id="anonymous-downloads-from-github-are-subject-to-the-limit-of-60-requests-per-hour-normally-such-rate-limit-is-enough" tabindex="-1"><a class="header-anchor" href="#anonymous-downloads-from-github-are-subject-to-the-limit-of-60-requests-per-hour-normally-such-rate-limit-is-enough" aria-hidden="true">#</a> Anonymous downloads from GitHub are subject to the limit of 60 requests per hour. Normally such rate limit is enough</h1><h1 id="for-production-operations-if-for-any-reason-it-s-not-enough-you-could-increase-the-rate-limit-to-5000" tabindex="-1"><a class="header-anchor" href="#for-production-operations-if-for-any-reason-it-s-not-enough-you-could-increase-the-rate-limit-to-5000" aria-hidden="true">#</a> for production operations. If, for any reason, it&#39;s not enough, you could increase the rate limit to 5000</h1><h1 id="requests-per-hour-by-specifying-the-github-access-token-for-more-details-on-github-rate-limiting-please-consult" tabindex="-1"><a class="header-anchor" href="#requests-per-hour-by-specifying-the-github-access-token-for-more-details-on-github-rate-limiting-please-consult" aria-hidden="true">#</a> requests per hour by specifying the GitHub access token. For more details on GitHub rate limiting please consult</h1><h1 id="https-developer-github-com-v3-rate-limiting" tabindex="-1"><a class="header-anchor" href="#https-developer-github-com-v3-rate-limiting" aria-hidden="true">#</a> https://developer.github.com/v3/#rate-limiting</h1><h1 id="-5" tabindex="-1"><a class="header-anchor" href="#-5" aria-hidden="true">#</a></h1><h1 id="you-can-create-a-github-token-by-following-the-instructions-in" tabindex="-1"><a class="header-anchor" href="#you-can-create-a-github-token-by-following-the-instructions-in" aria-hidden="true">#</a> You can create a GitHub token by following the instructions in</h1><h1 id="https-help-github-com-en-github-authenticating-to-github-creating-a-personal-access-token-for-the-command-line" tabindex="-1"><a class="header-anchor" href="#https-help-github-com-en-github-authenticating-to-github-creating-a-personal-access-token-for-the-command-line" aria-hidden="true">#</a> https://help.github.com/en/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line</h1><h1 id="-6" tabindex="-1"><a class="header-anchor" href="#-6" aria-hidden="true">#</a></h1><h1 id="github-token-xxx" tabindex="-1"><a class="header-anchor" href="#github-token-xxx" aria-hidden="true">#</a> github_token: xxx</h1><p>jobservice:</p><h1 id="maximum-number-of-job-workers-in-job-service" tabindex="-1"><a class="header-anchor" href="#maximum-number-of-job-workers-in-job-service" aria-hidden="true">#</a> Maximum number of job workers in job service</h1><p>max_job_workers: 10</p><p>notification:</p><h1 id="maximum-retry-count-for-webhook-job" tabindex="-1"><a class="header-anchor" href="#maximum-retry-count-for-webhook-job" aria-hidden="true">#</a> Maximum retry count for webhook job</h1><p>webhook_job_max_retry: 10</p><p>chart:</p><h1 id="change-the-value-of-absolute-url-to-enabled-can-enable-absolute-url-in-chart" tabindex="-1"><a class="header-anchor" href="#change-the-value-of-absolute-url-to-enabled-can-enable-absolute-url-in-chart" aria-hidden="true">#</a> Change the value of absolute_url to enabled can enable absolute url in chart</h1><p>absolute_url: disabled</p><h1 id="log-configurations" tabindex="-1"><a class="header-anchor" href="#log-configurations" aria-hidden="true">#</a> Log configurations</h1><p>log:</p><h1 id="options-are-debug-info-warning-error-fatal" tabindex="-1"><a class="header-anchor" href="#options-are-debug-info-warning-error-fatal" aria-hidden="true">#</a> options are debug, info, warning, error, fatal</h1><p>level: info</p><h1 id="configs-for-logs-in-local-storage" tabindex="-1"><a class="header-anchor" href="#configs-for-logs-in-local-storage" aria-hidden="true">#</a> configs for logs in local storage</h1><p>local: # Log files are rotated log_rotate_count times before being removed. If count is 0, old versions are removed rather than rotated. rotate_count: 50 # Log files are rotated only if they grow bigger than log_rotate_size bytes. If size is followed by k, the size is assumed to be in kilobytes. # If the M is used, the size is in megabytes, and if G is used, the size is in gigabytes. So size 100, size 100k, size 100M and size 100G # are all valid. rotate_size: 200M # The directory on your host that store log location: /var/log/harbor</p><h1 id="uncomment-following-lines-to-enable-external-syslog-endpoint" tabindex="-1"><a class="header-anchor" href="#uncomment-following-lines-to-enable-external-syslog-endpoint" aria-hidden="true">#</a> Uncomment following lines to enable external syslog endpoint.</h1><h1 id="external-endpoint" tabindex="-1"><a class="header-anchor" href="#external-endpoint" aria-hidden="true">#</a> external_endpoint:</h1><h1 id="protocol-used-to-transmit-log-to-external-endpoint-options-is-tcp-or-udp" tabindex="-1"><a class="header-anchor" href="#protocol-used-to-transmit-log-to-external-endpoint-options-is-tcp-or-udp" aria-hidden="true">#</a> # protocol used to transmit log to external endpoint, options is tcp or udp</h1><h1 id="protocol-tcp" tabindex="-1"><a class="header-anchor" href="#protocol-tcp" aria-hidden="true">#</a> protocol: tcp</h1><h1 id="the-host-of-external-endpoint" tabindex="-1"><a class="header-anchor" href="#the-host-of-external-endpoint" aria-hidden="true">#</a> # The host of external endpoint</h1><h1 id="host-localhost" tabindex="-1"><a class="header-anchor" href="#host-localhost" aria-hidden="true">#</a> host: localhost</h1><h1 id="port-of-external-endpoint" tabindex="-1"><a class="header-anchor" href="#port-of-external-endpoint" aria-hidden="true">#</a> # Port of external endpoint</h1><h1 id="port-5140" tabindex="-1"><a class="header-anchor" href="#port-5140" aria-hidden="true">#</a> port: 5140</h1><p>#This attribute is for migrator to detect the version of the .cfg file, DO NOT MODIFY! _version: 2.4.0</p><h1 id="uncomment-external-database-if-using-external-database" tabindex="-1"><a class="header-anchor" href="#uncomment-external-database-if-using-external-database" aria-hidden="true">#</a> Uncomment external_database if using external database.</h1><h1 id="external-database" tabindex="-1"><a class="header-anchor" href="#external-database" aria-hidden="true">#</a> external_database:</h1><h1 id="harbor" tabindex="-1"><a class="header-anchor" href="#harbor" aria-hidden="true">#</a> harbor:</h1><h1 id="host-harbor-db-host" tabindex="-1"><a class="header-anchor" href="#host-harbor-db-host" aria-hidden="true">#</a> host: harbor_db_host</h1><h1 id="port-harbor-db-port" tabindex="-1"><a class="header-anchor" href="#port-harbor-db-port" aria-hidden="true">#</a> port: harbor_db_port</h1><h1 id="db-name-harbor-db-name" tabindex="-1"><a class="header-anchor" href="#db-name-harbor-db-name" aria-hidden="true">#</a> db_name: harbor_db_name</h1><h1 id="username-harbor-db-username" tabindex="-1"><a class="header-anchor" href="#username-harbor-db-username" aria-hidden="true">#</a> username: harbor_db_username</h1><h1 id="password-harbor-db-password" tabindex="-1"><a class="header-anchor" href="#password-harbor-db-password" aria-hidden="true">#</a> password: harbor_db_password</h1><h1 id="ssl-mode-disable" tabindex="-1"><a class="header-anchor" href="#ssl-mode-disable" aria-hidden="true">#</a> ssl_mode: disable</h1><h1 id="max-idle-conns-2" tabindex="-1"><a class="header-anchor" href="#max-idle-conns-2" aria-hidden="true">#</a> max_idle_conns: 2</h1><h1 id="max-open-conns-0" tabindex="-1"><a class="header-anchor" href="#max-open-conns-0" aria-hidden="true">#</a> max_open_conns: 0</h1><h1 id="notary-signer" tabindex="-1"><a class="header-anchor" href="#notary-signer" aria-hidden="true">#</a> notary_signer:</h1><h1 id="host-notary-signer-db-host" tabindex="-1"><a class="header-anchor" href="#host-notary-signer-db-host" aria-hidden="true">#</a> host: notary_signer_db_host</h1><h1 id="port-notary-signer-db-port" tabindex="-1"><a class="header-anchor" href="#port-notary-signer-db-port" aria-hidden="true">#</a> port: notary_signer_db_port</h1><h1 id="db-name-notary-signer-db-name" tabindex="-1"><a class="header-anchor" href="#db-name-notary-signer-db-name" aria-hidden="true">#</a> db_name: notary_signer_db_name</h1><h1 id="username-notary-signer-db-username" tabindex="-1"><a class="header-anchor" href="#username-notary-signer-db-username" aria-hidden="true">#</a> username: notary_signer_db_username</h1><h1 id="password-notary-signer-db-password" tabindex="-1"><a class="header-anchor" href="#password-notary-signer-db-password" aria-hidden="true">#</a> password: notary_signer_db_password</h1><h1 id="ssl-mode-disable-1" tabindex="-1"><a class="header-anchor" href="#ssl-mode-disable-1" aria-hidden="true">#</a> ssl_mode: disable</h1><h1 id="notary-server" tabindex="-1"><a class="header-anchor" href="#notary-server" aria-hidden="true">#</a> notary_server:</h1><h1 id="host-notary-server-db-host" tabindex="-1"><a class="header-anchor" href="#host-notary-server-db-host" aria-hidden="true">#</a> host: notary_server_db_host</h1><h1 id="port-notary-server-db-port" tabindex="-1"><a class="header-anchor" href="#port-notary-server-db-port" aria-hidden="true">#</a> port: notary_server_db_port</h1><h1 id="db-name-notary-server-db-name" tabindex="-1"><a class="header-anchor" href="#db-name-notary-server-db-name" aria-hidden="true">#</a> db_name: notary_server_db_name</h1><h1 id="username-notary-server-db-username" tabindex="-1"><a class="header-anchor" href="#username-notary-server-db-username" aria-hidden="true">#</a> username: notary_server_db_username</h1><h1 id="password-notary-server-db-password" tabindex="-1"><a class="header-anchor" href="#password-notary-server-db-password" aria-hidden="true">#</a> password: notary_server_db_password</h1><h1 id="ssl-mode-disable-2" tabindex="-1"><a class="header-anchor" href="#ssl-mode-disable-2" aria-hidden="true">#</a> ssl_mode: disable</h1><h1 id="uncomment-external-redis-if-using-external-redis-server" tabindex="-1"><a class="header-anchor" href="#uncomment-external-redis-if-using-external-redis-server" aria-hidden="true">#</a> Uncomment external_redis if using external Redis server</h1><h1 id="external-redis" tabindex="-1"><a class="header-anchor" href="#external-redis" aria-hidden="true">#</a> external_redis:</h1><h1 id="support-redis-redis-sentinel" tabindex="-1"><a class="header-anchor" href="#support-redis-redis-sentinel" aria-hidden="true">#</a> # support redis, redis+sentinel</h1><h1 id="host-for-redis-host-redis-port-redis" tabindex="-1"><a class="header-anchor" href="#host-for-redis-host-redis-port-redis" aria-hidden="true">#</a> # host for redis: &lt;host_redis&gt;:&lt;port_redis&gt;</h1><h1 id="host-for-redis-sentinel" tabindex="-1"><a class="header-anchor" href="#host-for-redis-sentinel" aria-hidden="true">#</a> # host for redis+sentinel:</h1><h1 id="host-sentinel1-port-sentinel1-host-sentinel2-port-sentinel2-host-sentinel3-port-sentinel3" tabindex="-1"><a class="header-anchor" href="#host-sentinel1-port-sentinel1-host-sentinel2-port-sentinel2-host-sentinel3-port-sentinel3" aria-hidden="true">#</a> # &lt;host_sentinel1&gt;:&lt;port_sentinel1&gt;,&lt;host_sentinel2&gt;:&lt;port_sentinel2&gt;,&lt;host_sentinel3&gt;:&lt;port_sentinel3&gt;</h1><h1 id="host-redis-6379" tabindex="-1"><a class="header-anchor" href="#host-redis-6379" aria-hidden="true">#</a> host: redis:6379</h1><h1 id="password" tabindex="-1"><a class="header-anchor" href="#password" aria-hidden="true">#</a> password:</h1><h1 id="sentinel-master-set-must-be-set-to-support-redis-sentinel" tabindex="-1"><a class="header-anchor" href="#sentinel-master-set-must-be-set-to-support-redis-sentinel" aria-hidden="true">#</a> # sentinel_master_set must be set to support redis+sentinel</h1><h1 id="sentinel-master-set" tabindex="-1"><a class="header-anchor" href="#sentinel-master-set" aria-hidden="true">#</a> #sentinel_master_set:</h1><h1 id="db-index-0-is-for-core-it-s-unchangeable" tabindex="-1"><a class="header-anchor" href="#db-index-0-is-for-core-it-s-unchangeable" aria-hidden="true">#</a> # db_index 0 is for core, it&#39;s unchangeable</h1><h1 id="registry-db-index-1" tabindex="-1"><a class="header-anchor" href="#registry-db-index-1" aria-hidden="true">#</a> registry_db_index: 1</h1><h1 id="jobservice-db-index-2" tabindex="-1"><a class="header-anchor" href="#jobservice-db-index-2" aria-hidden="true">#</a> jobservice_db_index: 2</h1><h1 id="chartmuseum-db-index-3" tabindex="-1"><a class="header-anchor" href="#chartmuseum-db-index-3" aria-hidden="true">#</a> chartmuseum_db_index: 3</h1><h1 id="trivy-db-index-5" tabindex="-1"><a class="header-anchor" href="#trivy-db-index-5" aria-hidden="true">#</a> trivy_db_index: 5</h1><h1 id="idle-timeout-seconds-30" tabindex="-1"><a class="header-anchor" href="#idle-timeout-seconds-30" aria-hidden="true">#</a> idle_timeout_seconds: 30</h1><h1 id="uncomment-uaa-for-trusting-the-certificate-of-uaa-instance-that-is-hosted-via-self-signed-cert" tabindex="-1"><a class="header-anchor" href="#uncomment-uaa-for-trusting-the-certificate-of-uaa-instance-that-is-hosted-via-self-signed-cert" aria-hidden="true">#</a> Uncomment uaa for trusting the certificate of uaa instance that is hosted via self-signed cert.</h1><h1 id="uaa" tabindex="-1"><a class="header-anchor" href="#uaa" aria-hidden="true">#</a> uaa:</h1><h1 id="ca-file-path-to-ca" tabindex="-1"><a class="header-anchor" href="#ca-file-path-to-ca" aria-hidden="true">#</a> ca_file: /path/to/ca</h1><h1 id="global-proxy" tabindex="-1"><a class="header-anchor" href="#global-proxy" aria-hidden="true">#</a> Global proxy</h1><h1 id="config-http-proxy-for-components-e-g-http-my-proxy-com-3128" tabindex="-1"><a class="header-anchor" href="#config-http-proxy-for-components-e-g-http-my-proxy-com-3128" aria-hidden="true">#</a> Config http proxy for components, e.g. http://my.proxy.com:3128</h1><h1 id="components-doesn-t-need-to-connect-to-each-others-via-http-proxy" tabindex="-1"><a class="header-anchor" href="#components-doesn-t-need-to-connect-to-each-others-via-http-proxy" aria-hidden="true">#</a> Components doesn&#39;t need to connect to each others via http proxy.</h1><h1 id="remove-component-from-components-array-if-want-disable-proxy" tabindex="-1"><a class="header-anchor" href="#remove-component-from-components-array-if-want-disable-proxy" aria-hidden="true">#</a> Remove component from <code>components</code> array if want disable proxy</h1><h1 id="for-it-if-you-want-use-proxy-for-replication-must-enable-proxy" tabindex="-1"><a class="header-anchor" href="#for-it-if-you-want-use-proxy-for-replication-must-enable-proxy" aria-hidden="true">#</a> for it. If you want use proxy for replication, MUST enable proxy</h1><h1 id="for-core-and-jobservice-and-set-http-proxy-and-https-proxy" tabindex="-1"><a class="header-anchor" href="#for-core-and-jobservice-and-set-http-proxy-and-https-proxy" aria-hidden="true">#</a> for core and jobservice, and set <code>http_proxy</code> and <code>https_proxy</code>.</h1><h1 id="add-domain-to-the-no-proxy-field-when-you-want-disable-proxy" tabindex="-1"><a class="header-anchor" href="#add-domain-to-the-no-proxy-field-when-you-want-disable-proxy" aria-hidden="true">#</a> Add domain to the <code>no_proxy</code> field, when you want disable proxy</h1><h1 id="for-some-special-registry" tabindex="-1"><a class="header-anchor" href="#for-some-special-registry" aria-hidden="true">#</a> for some special registry.</h1><p>proxy: http_proxy: https_proxy: no_proxy: components: - core - jobservice - trivy</p><h1 id="metric" tabindex="-1"><a class="header-anchor" href="#metric" aria-hidden="true">#</a> metric:</h1><h1 id="enabled-false" tabindex="-1"><a class="header-anchor" href="#enabled-false" aria-hidden="true">#</a> enabled: false</h1><h1 id="port-9090" tabindex="-1"><a class="header-anchor" href="#port-9090" aria-hidden="true">#</a> port: 9090</h1><h1 id="path-metrics" tabindex="-1"><a class="header-anchor" href="#path-metrics" aria-hidden="true">#</a> path: /metrics</h1><h1 id="trace-related-config" tabindex="-1"><a class="header-anchor" href="#trace-related-config" aria-hidden="true">#</a> Trace related config</h1><h1 id="only-can-enable-one-trace-provider-jaeger-or-otel-at-the-same-time" tabindex="-1"><a class="header-anchor" href="#only-can-enable-one-trace-provider-jaeger-or-otel-at-the-same-time" aria-hidden="true">#</a> only can enable one trace provider(jaeger or otel) at the same time,</h1><h1 id="and-when-using-jaeger-as-provider-can-only-enable-it-with-agent-mode-or-collector-mode" tabindex="-1"><a class="header-anchor" href="#and-when-using-jaeger-as-provider-can-only-enable-it-with-agent-mode-or-collector-mode" aria-hidden="true">#</a> and when using jaeger as provider, can only enable it with agent mode or collector mode.</h1><h1 id="if-using-jaeger-collector-mode-uncomment-endpoint-and-uncomment-username-password-if-needed" tabindex="-1"><a class="header-anchor" href="#if-using-jaeger-collector-mode-uncomment-endpoint-and-uncomment-username-password-if-needed" aria-hidden="true">#</a> if using jaeger collector mode, uncomment endpoint and uncomment username, password if needed</h1><h1 id="if-using-jaeger-agetn-mode-uncomment-agent-host-and-agent-port" tabindex="-1"><a class="header-anchor" href="#if-using-jaeger-agetn-mode-uncomment-agent-host-and-agent-port" aria-hidden="true">#</a> if using jaeger agetn mode uncomment agent_host and agent_port</h1><h1 id="trace" tabindex="-1"><a class="header-anchor" href="#trace" aria-hidden="true">#</a> trace:</h1><h1 id="enabled-true-1" tabindex="-1"><a class="header-anchor" href="#enabled-true-1" aria-hidden="true">#</a> enabled: true</h1><h1 id="set-sample-rate-to-1-if-you-wanna-sampling-100-of-trace-data-set-0-5-if-you-wanna-sampling-50-of-trace-data-and-so-forth" tabindex="-1"><a class="header-anchor" href="#set-sample-rate-to-1-if-you-wanna-sampling-100-of-trace-data-set-0-5-if-you-wanna-sampling-50-of-trace-data-and-so-forth" aria-hidden="true">#</a> # set sample_rate to 1 if you wanna sampling 100% of trace data; set 0.5 if you wanna sampling 50% of trace data, and so forth</h1><h1 id="sample-rate-1" tabindex="-1"><a class="header-anchor" href="#sample-rate-1" aria-hidden="true">#</a> sample_rate: 1</h1><h1 id="namespace-used-to-differenciate-different-harbor-services" tabindex="-1"><a class="header-anchor" href="#namespace-used-to-differenciate-different-harbor-services" aria-hidden="true">#</a> # # namespace used to differenciate different harbor services</h1><h1 id="namespace" tabindex="-1"><a class="header-anchor" href="#namespace" aria-hidden="true">#</a> # namespace:</h1><h1 id="attributes-is-a-key-value-dict-contains-user-defined-attributes-used-to-initialize-trace-provider" tabindex="-1"><a class="header-anchor" href="#attributes-is-a-key-value-dict-contains-user-defined-attributes-used-to-initialize-trace-provider" aria-hidden="true">#</a> # # attributes is a key value dict contains user defined attributes used to initialize trace provider</h1><h1 id="attributes" tabindex="-1"><a class="header-anchor" href="#attributes" aria-hidden="true">#</a> # attributes:</h1><h1 id="application-harbor" tabindex="-1"><a class="header-anchor" href="#application-harbor" aria-hidden="true">#</a> # application: harbor</h1><h1 id="jaeger-should-be-1-26-or-newer" tabindex="-1"><a class="header-anchor" href="#jaeger-should-be-1-26-or-newer" aria-hidden="true">#</a> # # jaeger should be 1.26 or newer.</h1><h1 id="jaeger" tabindex="-1"><a class="header-anchor" href="#jaeger" aria-hidden="true">#</a> # jaeger:</h1><h1 id="endpoint-http-hostname-14268-api-traces" tabindex="-1"><a class="header-anchor" href="#endpoint-http-hostname-14268-api-traces" aria-hidden="true">#</a> # endpoint: http://hostname:14268/api/traces</h1><h1 id="username" tabindex="-1"><a class="header-anchor" href="#username" aria-hidden="true">#</a> # username:</h1><h1 id="password-1" tabindex="-1"><a class="header-anchor" href="#password-1" aria-hidden="true">#</a> # password:</h1><h1 id="agent-host-hostname" tabindex="-1"><a class="header-anchor" href="#agent-host-hostname" aria-hidden="true">#</a> # agent_host: hostname</h1><h1 id="export-trace-data-by-jaeger-thrift-in-compact-mode" tabindex="-1"><a class="header-anchor" href="#export-trace-data-by-jaeger-thrift-in-compact-mode" aria-hidden="true">#</a> # # export trace data by jaeger.thrift in compact mode</h1><h1 id="agent-port-6831" tabindex="-1"><a class="header-anchor" href="#agent-port-6831" aria-hidden="true">#</a> # agent_port: 6831</h1><h1 id="otel" tabindex="-1"><a class="header-anchor" href="#otel" aria-hidden="true">#</a> # otel:</h1><h1 id="endpoint-hostname-4318" tabindex="-1"><a class="header-anchor" href="#endpoint-hostname-4318" aria-hidden="true">#</a> # endpoint: hostname:4318</h1><h1 id="url-path-v1-traces" tabindex="-1"><a class="header-anchor" href="#url-path-v1-traces" aria-hidden="true">#</a> # url_path: /v1/traces</h1><h1 id="compression-false" tabindex="-1"><a class="header-anchor" href="#compression-false" aria-hidden="true">#</a> # compression: false</h1><h1 id="insecure-true" tabindex="-1"><a class="header-anchor" href="#insecure-true" aria-hidden="true">#</a> # insecure: true</h1><h1 id="timeout-10s" tabindex="-1"><a class="header-anchor" href="#timeout-10s" aria-hidden="true">#</a> # timeout: 10s</h1><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>

以上配置文件，主要修改了hostname为需要使用的域名，默认http和https端口，以及ca证书的存放位置。
### 启动harbor
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>./prepare sudo ./install.sh</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>等待各个docker下载完成，自动启动，然后打开浏览器，输入网址：hostname:8443，即可登录harbor。
在harbor新建项目tomact。
## docker 操作 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>docker pull tomcat docker tag tomact:latest hostname:8443/test/tomcat:latest docker login -u admin -p Harbor12345 hostname:8443 docker push hostname:8443/test/tomcat:latest</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code></code></pre><div class="line-numbers" aria-hidden="true"></div></div>`,209);function b(f,p){const t=i("ExternalLinkIcon");return o(),d("div",null,[c,a("p",null,[e("在"),a("a",l,[e("官方发布"),s(t)]),e("页面下载最新release版本，我下载了online版本。 解压后如下:")]),u])}const g=n(h,[["render",b],["__file","harbor.html.vue"]]);export{g as default};
